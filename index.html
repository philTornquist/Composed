<html>
    
    <body>
        <table>
            <tr>  
                <td>
                  <table>
                    <tr>
                    <td>
                        <button id="runButton" onclick="clickedRun()">Run</button>
                    </td>
                    </tr>
                    <tr>
                    <td>
                        <label><input type="checkbox" id="logExecution" value="value">Log Execution</label>
                    </td>
                    </tr>
                    <tr>
                    <td>
                        <label><input type="checkbox" id="logJITTING" value="value">Log JIT</label>
                    </td>
                    </tr>
                    <tr>
                    <td>
                        <label><input type="checkbox" id="logRestructure" value="value">Log Generic Creation</label>
                    </td>
                    </tr>
                  </table>
                </td>
                <td>
                 <textarea id="output" rows=30 cols=100>
</textarea>
            </tr>
        </table>
    <div>

        <textarea id="code" rows=50 cols=100>
Test1 = Point2D,X,Y 1,2:
Test2 = Summation,List'Number' [[[Nothing,3],2],1]:
Test3 = STD,List'Number' [[[[Nothing,4],3],2],1]:


X is Number
Y is Number
Point2D is X, Y

IsLessThan5 is Number:
   [value, 5] > Compare'Number' {
       less: value
   } > Number

Summation is Sum
Sum from Number(n), Sum(s):
    [
        n,
        s > Number
    ] > Sum
Summation from List'Number'(l):
   [
       l,
       [0,0] > Sum
   ] > Foldl'Sum' > Sum > Summation

Average is Number
Average from Sum(s), Count(c):
    [
        s > Number,
        c > Number
    ] > Quotient > Number > Average

Average from List'Number'(l):
    [
        l > Summation > Sum,
        l > Count
    ] > Average

STD is Number
STD from List'Number'(l):
    [
        [
            l,
            l > Average > Number
        ] > Map'Difference' > Map'Number' > Map'Square' > Map'Number' > List'Number' > Summation > Sum > Number,
        [
            l > Count > Number,
            1
        ] > Difference > Number
    ] > Quotient > Number > SquareRoot > Number > STD
</textarea>
<textarea id="bytecode" rows=50 cols=100></textarea>
<textarea id="jsCode" rows=50 cols=100></textarea>
    </div>
    
    <script src="Library/List.cps.js"></script>
    <script src="Library/Bool.cps.js"></script>
    <script src="Library/String.cps.js"></script>

    <script src="LogHistory.js"></script>
    <script src="ConversionUtils.js"></script>

    <script src="Compiler.js"></script>

    <script src="Linker.js"></script>
    <script src="Built-In.js"></script>
    <script src="Interpreter.js"></script>

    <script src="Test_Interpreter.cps.js"></script>
 
    <script src="JSCompiler.js"></script>
    <script src="Test_JSCompiler.js"></script>

    <script src="ComposedCompiler.cps.js"></script>
    <script src="Builder.js"></script>

<script>
    window.onload = function()
    {
        document.getElementById("code").value += List_CPS;
        
        LOG(["RUNNING SANITY CHECKS"]);
        LOG("The following output is the result of running some weird Composed code that");
        LOG("verifies the compiler, optimizer, and runtime are working correctly\n\n");
        LOG("Press the 'Run' button to see the sample code run");
        LOG([]);
        Test_JSCompiler();
        RunCompiler();
    }
    
    function clickedRun()
    {
        log_js_execution = document.getElementById("logExecution").checked ? LOG : NLOG;
        log_linker_restructure = document.getElementById("logRestructure").checked ? LOG : NLOG;
        log_jitting = document.getElementById("logJITTING").checked ? LOG : NLOG;
        log_js_compilation = log_jitting;
    
        var code = document.getElementById("code").value;
        document.getElementById("output").value = "";
        RESET();
        Data.JIT = js_conversion;
        
        var conversions = compile(code);
        load_bytecode(Data, conversions);
        
        
        document.getElementById("bytecode").value = conversions;
        document.getElementById("jsCode").value = "";
        
        link_conversions(Data);
        
        
        var missingMsg = "";
        for (var key in Data.Missing)
            missingMsg += key + "\n";
            
          
        if (missingMsg == "")
            runInline();
        else
            alert("Missing the following conversions:\n" + missingMsg)
    }
</script>

    </body>
</html>
